"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[1109],{1109:(he,Z,l)=>{l.r(Z),l.d(Z,{FloatlabelDemoModule:()=>pe});var h=l(6814),c=l(95),v=l(3557),g=l(9862),b=l(5118),u=l(5219),e=l(4769),M=l(5905),F=l(8814),S=l(7744),N=l(981),T=l(1865),D=l(7327),C=l(707),f=l(3714),_=l(3965),x=l(5167),A=l(4104),m=l(9552),y=l(1312),U=l(8608);function L(n,s){if(1&n){const i=e.EpF();e.TgZ(0,"div",15)(1,"b",16),e._uU(2),e.qZA(),e._uU(3,"| "),e.TgZ(4,"b"),e._uU(5,"ONLINE"),e.qZA(),e._UZ(6,"p-badge",17),e._uU(7,"| "),e.TgZ(8,"b"),e._uU(9,"OFFLINE"),e.qZA(),e._UZ(10,"p-badge",18)(11,"br"),e.TgZ(12,"span",19),e._UZ(13,"i",20),e.TgZ(14,"button",21),e.NdJ("click",function(){e.CHM(i);const o=e.oxw();return e.KtG(o.openNew2())}),e.qZA()()()}if(2&n){const i=e.oxw();e.xp6(2),e.hij("Total Device : ",i.stockList?i.stockList.length:0,""),e.xp6(4),e.Q6J("value",i.totOnline),e.xp6(4),e.Q6J("value",i.totOffilne)}}function q(n,s){1&n&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"Sl No."),e.qZA(),e.TgZ(3,"th",22),e._uU(4,"Device"),e._UZ(5,"p-sortIcon",23),e.qZA(),e.TgZ(6,"th",24),e._uU(7,"Device Name "),e._UZ(8,"p-sortIcon",23),e.qZA(),e.TgZ(9,"th",25),e._uU(10,"Device Type "),e._UZ(11,"p-sortIcon",23),e.qZA(),e.TgZ(12,"th",26),e._uU(13,"Model"),e._UZ(14,"p-sortIcon",27),e.qZA(),e.TgZ(15,"th",28),e._uU(16,"Latitude "),e._UZ(17,"p-sortIcon",29),e.qZA(),e.TgZ(18,"th",30),e._uU(19,"Longitude "),e._UZ(20,"p-sortIcon",29),e.qZA(),e.TgZ(21,"th",31),e._uU(22,"Status "),e._UZ(23,"p-sortIcon",32),e.qZA(),e.TgZ(24,"th"),e._uU(25,"Edit"),e.qZA()())}function I(n,s){if(1&n){const i=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.qZA(),e.TgZ(15,"th",33),e._UZ(16,"p-badge",34),e.qZA(),e.TgZ(17,"td",33)(18,"button",35),e.NdJ("click",function(){const a=e.CHM(i).$implicit,d=e.oxw();return e.KtG(d.editProduct(a))}),e.qZA()()()}if(2&n){const i=s.rowIndex,t=s.$implicit;e.xp6(2),e.Oqu(i+1),e.xp6(2),e.Oqu(t.device),e.xp6(2),e.Oqu(t.device_name),e.xp6(2),e.Oqu("Street Light"),e.xp6(2),e.Oqu(t.model),e.xp6(2),e.Oqu(t.lat),e.xp6(2),e.Oqu(t.lon),e.xp6(2),e.Q6J("value","Y"==t.status?"Online":"Offline")("severity","Y"==t.status?"success":"danger")}}function J(n,s){if(1&n&&(e.TgZ(0,"div",15),e._uU(1),e.qZA()),2&n){const i=e.oxw();e.xp6(1),e.hij("In total there are ",i.stockList?i.stockList.length:0," devices.")}}function O(n,s){1&n&&(e.TgZ(0,"small",52),e._uU(1,"Name is required."),e.qZA())}const Y=function(){return{standalone:!0}};function k(n,s){if(1&n){const i=e.EpF();e.TgZ(0,"div",36)(1,"label",37),e._uU(2,"Devuce id"),e.qZA(),e.TgZ(3,"p-autoComplete",38),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.selectedDealer=o)})("onSelect",function(){e.CHM(i);const o=e.oxw();return e.KtG(o.setDevice())})("completeMethod",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.filterDealer(o))}),e.qZA(),e.YNc(4,O,2,0,"small",39),e.qZA(),e.TgZ(5,"div",36)(6,"label",40),e._uU(7,"Status"),e.qZA(),e.TgZ(8,"div",41)(9,"div",42)(10,"p-radioButton",43),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.product.category=o)}),e.qZA(),e.TgZ(11,"label",44),e._uU(12,"Active"),e.qZA()(),e.TgZ(13,"div",42)(14,"p-radioButton",45),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.product.category=o)}),e.qZA(),e.TgZ(15,"label",46),e._uU(16,"Deactive"),e.qZA()()()(),e.TgZ(17,"div",41)(18,"div",47)(19,"label",48),e._uU(20,"Model"),e.qZA(),e.TgZ(21,"p-dropdown",49),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.selectedCity=o)}),e.qZA()(),e.TgZ(22,"div",47)(23,"label",50),e._uU(24,"Battery(%)"),e.qZA(),e.TgZ(25,"p-inputNumber",51),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.product.quantity=o)}),e.qZA()()()}if(2&n){const i=e.oxw();e.xp6(3),e.Q6J("ngModel",i.selectedDealer)("ngModelOptions",e.DdM(11,Y))("suggestions",i.filteredDealer)("dropdown",!0),e.xp6(1),e.Q6J("ngIf",i.submitted&&!i.product.name),e.xp6(6),e.Q6J("ngModel",i.product.category),e.xp6(4),e.Q6J("ngModel",i.product.category),e.xp6(7),e.Q6J("options",i.DeviceModel)("ngModel",i.selectedCity)("showClear",!0),e.xp6(4),e.Q6J("ngModel",i.product.quantity)}}function w(n,s){if(1&n){const i=e.EpF();e.TgZ(0,"button",53),e.NdJ("click",function(){e.CHM(i);const o=e.oxw();return e.KtG(o.hideDialog())}),e.qZA(),e.TgZ(1,"button",54),e.NdJ("click",function(){e.CHM(i);const o=e.oxw();return e.KtG(o.saveProduct())}),e.qZA()}}function E(n,s){if(1&n&&(e.TgZ(0,"option",67),e._uU(1),e.qZA()),2&n){const i=s.$implicit;e.Q6J("value",i.code),e.xp6(1),e.hij(" ",i.name," ")}}function P(n,s){if(1&n&&(e.TgZ(0,"form",55)(1,"div",56)(2,"label",37)(3,"span",57),e._uU(4,"*"),e.qZA(),e._uU(5,"Device Name"),e.qZA(),e._UZ(6,"input",58),e.qZA(),e.TgZ(7,"div",56)(8,"label",37)(9,"span",57),e._uU(10,"*"),e.qZA(),e._uU(11,"Device"),e.qZA(),e._UZ(12,"input",59),e.qZA(),e.TgZ(13,"div",56)(14,"label",37)(15,"span",57),e._uU(16,"*"),e.qZA(),e._uU(17,"Model"),e.qZA(),e._UZ(18,"input",60),e.qZA(),e.TgZ(19,"div",56)(20,"label",61)(21,"span",57),e._uU(22,"*"),e.qZA(),e._uU(23,"Device Type"),e.qZA(),e.TgZ(24,"select",62)(25,"option",63),e._uU(26,"Select an option"),e.qZA(),e.YNc(27,E,2,2,"option",64),e.qZA()(),e.TgZ(28,"div",56)(29,"label",37)(30,"span",57),e._uU(31,"*"),e.qZA(),e._uU(32,"Latitude"),e.qZA(),e._UZ(33,"input",65),e.qZA(),e.TgZ(34,"div",56)(35,"label",37)(36,"span",57),e._uU(37,"*"),e.qZA(),e._uU(38,"Longitude"),e.qZA(),e._UZ(39,"input",66),e.qZA()()),2&n){const i=e.oxw();e.Q6J("formGroup",i.addDevice),e.xp6(25),e.Q6J("value",0),e.xp6(2),e.Q6J("ngForOf",i.DeviceType)}}function Q(n,s){if(1&n){const i=e.EpF();e.TgZ(0,"button",53),e.NdJ("click",function(){e.CHM(i);const o=e.oxw();return e.KtG(o.hideDialog())}),e.qZA(),e.TgZ(1,"button",54),e.NdJ("click",function(){e.CHM(i);const o=e.oxw();return e.KtG(o.saveProduct())}),e.qZA()}}function B(n,s){1&n&&(e.TgZ(0,"div",68),e._UZ(1,"div")(2,"div")(3,"div")(4,"div")(5,"div"),e.qZA())}function K(n,s){1&n&&e._UZ(0,"div",69)}const H=function(){return["device_id","modal","battery","status"]},G=function(){return{"min-width":"75rem"}},z=function(){return{width:"600px",height:"700px"}},R=function(){return{width:"650px",height:"500px"}};let W=(()=>{var n;class s{constructor(t,o,a,d,r,p,ue,ge,me){this.router=t,this.authservice=o,this.api=a,this.countryService=d,this.http=r,this.productService=p,this.fb=ue,this.messageService=ge,this.confirmationService=me,this.checked=!0,this.checked2=!1,this.productDialog=!1,this.AddproductDialog=!1,this.client_id=+localStorage.getItem("c_id"),this.spinner=!1,this.submitted=!1,this.stockList=[],this.loginType=localStorage.getItem("loginType"),this.totOnline=0,this.totOffilne=0,this.DeviceModel=[{name:"Energy",code:"EN"},{name:"Water",code:"WA"},{name:"Power",code:"PO"},{name:"Wind",code:"WI"}],this.DeviceType=[{name:"Street Light",code:"SL"}],this.meterType=[{name:"Single Phase",code:"ENSF"},{name:"Three Phase",code:"ENTF"}],this.addDevice=this.fb.group({did:[""],deviceName:["",[c.kI.required]],deviceId:["",[c.kI.required]],dmodel:["",[c.kI.required]],lat:["",[c.kI.required]],long:["",[c.kI.required]],device_type:["",[c.kI.required]]})}ngOnInit(){this.getAllStock(),this.ct=this.addDevice.controls,this.productService.getProducts().then(t=>this.products=t),this.statuses=[{label:"INSTOCK",value:"instock"},{label:"LOWSTOCK",value:"lowstock"},{label:"OUTOFSTOCK",value:"outofstock"}]}openNew(){this.operationType="U",this.product={},this.submitted=!1,this.AddproductDialog=!0}openNew2(){this.addDevice.reset(),this.addDevice.patchValue({device_type:0,meter_type:0}),this.operationType="I",this.product={},this.submitted=!1,this.AddproductDialog=!0}getSeverity(t){return"success"}deleteSelectedProducts(){this.confirmationService.confirm({message:"Are you sure you want to delete the selected products?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this.products=this.products.filter(t=>!this.selectedProducts?.includes(t)),this.selectedProducts=null,this.messageService.add({severity:"success",summary:"Successful",detail:"Products Deleted",life:3e3})}})}editProduct(t){this.operationType="U",this.addDevice.patchValue({did:t.device_id,deviceName:t.device_name,device_type:"SL",deviceId:t.device,dmodel:t.model,lat:t.lat,long:t.lon}),this.addDevice.controls.deviceId.disable(),this.AddproductDialog=!0}deleteProduct(t){this.confirmationService.confirm({message:"Are you sure you want to delete this Device ?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this.products=this.products.filter(o=>o.device_id!==t),this.product={},this.messageService.add({severity:"success",summary:"Successful",detail:"Device Deleted",life:3e3})}})}hideDialog(){this.AddproductDialog=!1,this.productDialog=!1,this.submitted=!1}calculateDifference(t){const o=new Date(t),d=Math.abs((new Date).getTime()-o.getTime()),r=Math.floor(d/6e4);return console.log(r),r}getAllStock(){this.spinner=!0;const t=this.api.baseUrl,o=localStorage.getItem("token"),a=(new g.WM).set("Authorization",`Bearer ${o}`);this.http.post(t+"/client/manage/devices/list",{client_id:this.client_id},{headers:a}).subscribe(r=>{this.spinner=!1,console.log(r),this.stockApi=r,this.stockList=this.stockApi.data,this.totOnline=0,this.totOffilne=0,this.stockList.forEach(p=>{this.calculateDifference(p.energy_data_created_at)<=60?(p.status="Y",this.totOnline+=1):(p.status="N",this.totOffilne+=1)})},r=>{"401"==r.status&&this.router.navigate(["/"]),console.log(r.status),this.spinner=!1,console.error(r)})}convDt(){var o=new Date(new Date);return o.getFullYear()+"-"+("0"+(o.getMonth()+1)).slice(-2)+"-"+("0"+o.getDate()).slice(-2)}saveProduct(){if(this.submitted=!0,this.addDevice.invalid)this.messageService.add({severity:"error",summary:"Error",detail:"Please fill all the required field!!",life:3e3});else if("I"==this.operationType){const t=this.api.baseUrl,o=localStorage.getItem("token"),a=(new g.WM).set("Authorization",`Bearer ${o}`),r=[{client_id:this.client_id,device_name:this.ct.deviceName.value,device:this.ct.deviceId.value,model:this.ct.dmodel.value,lat:this.ct.lat.value,lon:this.ct.long.value,device_type:"SL",do_channel:1,last_maintenance:this.convDt()}];this.http.post(t+"/client/manage/devices/add",r,{headers:a}).subscribe(p=>{console.log(p),this.spinner=!1,this.messageService.add({severity:"success",summary:"Successful",detail:"Device Created",life:3e3}),this.resetData(),this.getAllStock(),this.hideDialog()},p=>{"401"==p.status&&this.router.navigate(["/"]),console.log(p.status),this.spinner=!1,console.log(p),this.hideDialog(),this.messageService.add({severity:"error",summary:"Error",detail:":Unknown Error",life:3e3})})}else{const t=this.api.baseUrl,o=localStorage.getItem("token"),a=(new g.WM).set("Authorization",`Bearer ${o}`);this.http.post(t+"/client/manage/devices/edit",{device_id:this.ct.did.value,client_id:this.client_id,device_name:this.ct.deviceName.value,device:this.ct.deviceId.value,model:this.ct.dmodel.value,lat:this.ct.lat.value,lon:this.ct.long.value,device_type:"SL",do_channel:1},{headers:a}).subscribe(r=>{console.log(r),this.spinner=!1,this.messageService.add({severity:"success",summary:"Successful",detail:"Device Updated",life:3e3}),this.resetData(),this.getAllStock(),this.hideDialog()},r=>{"401"==r.status&&this.router.navigate(["/"]),console.log(r.status),this.spinner=!1,console.log(r),this.hideDialog(),this.messageService.add({severity:"error",summary:"Error",detail:":Unknown Error",life:3e3})})}}resetData(){this.addDevice.reset()}findIndexById(t){let o=-1;for(let a=0;a<this.products.length;a++)if(this.products[a].id===t){o=a;break}return o}createId(){let t="";for(var a=0;a<5;a++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return t}}return(n=s).\u0275fac=function(t){return new(t||n)(e.Y36(v.F0),e.Y36(M.$),e.Y36(F.s),e.Y36(S.T),e.Y36(g.eN),e.Y36(N.M),e.Y36(c.qu),e.Y36(u.ez),e.Y36(u.YP))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],features:[e._Bn([b.xA,u.ez])],decls:19,vars:22,consts:[[1,"col-12","lg:col-6","xl:col-12"],[1,"card"],[1,"m-2"],["dataKey","id","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","rows","paginator","globalFilterFields","tableStyle","selection","rowHover","showCurrentPageReport","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","summary"],["header","Device Details","styleClass","p-fluid",3,"visible","modal","visibleChange"],["pTemplate","content"],["pTemplate","footer"],["header","Add New Device","styleClass","p-fluid",3,"visible","modal","visibleChange"],["class","loader",4,"ngIf"],["class","overlay",4,"ngIf"],[1,"flex","align-items-center","justify-content-between"],[1,"text-900","font-medium","text-xl"],["severity","success",3,"value"],["severity","danger",3,"value"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pButton","","pRipple","","label","Add New Device","icon","pi pi-plus",1,"p-button-primary","mr-2",3,"click"],["pSortableColumn","device"],["field","name"],["pSortableColumn","device_name"],["pSortableColumn","device_type"],["pSortableColumn","model"],["field","price"],["pSortableColumn","lat"],["field","category"],["pSortableColumn","lon"],["pSortableColumn","energy_data_created_at"],["field","inventoryStatus"],[2,"text-align","center"],[3,"value","severity"],["type","button","pButton","","pRipple","","icon","pi pi-pencil",3,"click"],[1,"field"],["for","name"],["placeholder","ABCDE01001","field","device_name",3,"ngModel","ngModelOptions","suggestions","dropdown","ngModelChange","onSelect","completeMethod"],["class","p-error",4,"ngIf"],[1,"mb-3"],[1,"formgrid","grid"],[1,"field-radiobutton","col-6"],["id","category1","name","category","value","Active",3,"ngModel","ngModelChange"],["for","category1"],["id","category2","name","category","value","Deactive",3,"ngModel","ngModelChange"],["for","category2"],[1,"field","col"],["for","price"],["optionLabel","name","placeholder","Select a Model",3,"options","ngModel","showClear","ngModelChange"],["for","quantity"],["id","quantity",3,"ngModel","ngModelChange"],[1,"p-error"],["pButton","","pRipple","","label","Cancel","icon","pi pi-times",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Save","icon","pi pi-check",1,"p-button-text",3,"click"],[1,"grid",3,"formGroup"],[1,"col-6","lg:col-6","xl:col-6"],[2,"color","red"],["type","text","pInputText","","id","name","formControlName","deviceName","required","","autofocus",""],["type","text","pInputText","","id","name","formControlName","deviceId","required","","autofocus",""],["type","text","pInputText","","id","name","formControlName","dmodel","required","","autofocus",""],["htmlFor","firstname2"],["formControlName","device_type",2,"width","100%","height","42px","border-color","lightgray","border-radius","5px"],["disabled","","selected","",3,"value"],[3,"value",4,"ngFor","ngForOf"],["type","text","pInputText","","id","name","formControlName","lat","required","","autofocus",""],["type","text","pInputText","","id","name","formControlName","long","required","","autofocus",""],[3,"value"],[1,"loader"],[1,"overlay"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"p-toast"),e.TgZ(3,"h5",2),e._uU(4,"Manage Device"),e.qZA(),e.TgZ(5,"p-table",3,4),e.NdJ("selectionChange",function(d){return o.selectedProducts=d}),e.YNc(7,L,15,3,"ng-template",5),e.YNc(8,q,26,0,"ng-template",6),e.YNc(9,I,19,9,"ng-template",7),e.YNc(10,J,2,1,"ng-template",8),e.qZA()(),e.TgZ(11,"p-dialog",9),e.NdJ("visibleChange",function(d){return o.productDialog=d}),e.YNc(12,k,26,12,"ng-template",10),e.YNc(13,w,2,0,"ng-template",11),e.qZA(),e.TgZ(14,"p-dialog",12),e.NdJ("visibleChange",function(d){return o.AddproductDialog=d}),e.YNc(15,P,40,3,"ng-template",10),e.YNc(16,Q,2,0,"ng-template",11),e.qZA()(),e.YNc(17,B,6,0,"div",13),e.YNc(18,K,1,0,"div",14)),2&t&&(e.xp6(5),e.Q6J("value",o.stockList)("rows",10)("paginator",!0)("globalFilterFields",e.DdM(18,H))("tableStyle",e.DdM(19,G))("selection",o.selectedProducts)("rowHover",!0)("showCurrentPageReport",!0),e.xp6(6),e.Akn(e.DdM(20,z)),e.Q6J("visible",o.productDialog)("modal",!0),e.xp6(3),e.Akn(e.DdM(21,R)),e.Q6J("visible",o.AddproductDialog)("modal",!0),e.xp6(3),e.Q6J("ngIf",o.spinner),e.xp6(1),e.Q6J("ngIf",o.spinner))},dependencies:[T.EU,h.sg,h.O5,c._Y,c.YN,c.Kr,c.Fj,c.EJ,c.JJ,c.JL,c.Q7,c.On,D.Qc,u.jx,C.Hq,f.o,_.Lt,x.Rn,A.FN,m.iA,m.lQ,m.fz,y.V,c.sg,c.u,U.Ct],encapsulation:2}),s})(),j=(()=>{var n;class s{}return(n=s).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[v.Bz.forChild([{path:"",component:W}]),v.Bz]}),s})();var $=l(6760),X=l(1480),V=l(9663),ee=l(8062),te=l(4055),oe=l(6218),ie=l(4037),ne=l(8052),le=l(1825),ae=l(6022),se=l(2947),re=l(7680),ce=l(3514),de=l(5609);let pe=(()=>{var n;class s{}return(n=s).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[u.ez,u.YP],imports:[T.cc,h.ez,c.u5,j,D.WN,$._8,X.Gg,_.kW,V.zz,x.L$,ee.XH,te.q4,oe.A,f.j,ie.FI,ne.f,le.C,f.j,_.kW,ae.Xt,C.hJ,re.L,b.DL,A.EV,se.U,m.U$,y.S,c.UX,ce.dp,de.Iu,U.TX]}),s})()}}]);