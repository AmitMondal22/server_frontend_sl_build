"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[4623],{4623:(A,D,a)=>{a.r(D),a.d(D,{FormLayoutDemoModule:()=>W});var c=a(6814),r=a(95),f=a(2507),h=a(9862),g=a(5219),e=a(4769),m=a(8814),u=a(4104),_=a(7327),v=a(707),C=a(3714),b=a(5167);const F=["itemInput"];function T(n,d){1&n&&(e.TgZ(0,"div",16)(1,"label",17),e._uU(2,"Datalog Interval (Min)"),e.qZA(),e._UZ(3,"p-inputNumber",18),e.qZA()),2&n&&(e.xp6(3),e.Q6J("min",1))}function S(n,d){if(1&n){const p=e.EpF();e.TgZ(0,"div",16)(1,"div",19),e._UZ(2,"div",9),e.TgZ(3,"div",20)(4,"label",17),e._uU(5,"Light On"),e.qZA(),e._UZ(6,"br"),e.TgZ(7,"p-button",21),e.NdJ("click",function(){e.CHM(p);const i=e.oxw();return e.KtG(i.lightOn())}),e.qZA()(),e.TgZ(8,"div",20)(9,"label",17),e._uU(10,"Light Off"),e.qZA(),e._UZ(11,"br"),e.TgZ(12,"p-button",22),e.NdJ("click",function(){e.CHM(p);const i=e.oxw();return e.KtG(i.lightOff())}),e.qZA()()()()}2&n&&(e.xp6(7),e.Q6J("rounded",!0),e.xp6(5),e.Q6J("rounded",!0))}function Z(n,d){1&n&&(e.TgZ(0,"div",16)(1,"div",0)(2,"div",6)(3,"label",17),e._uU(4,"Sunrise Time"),e.qZA(),e._UZ(5,"input",23),e.qZA(),e.TgZ(6,"div",6)(7,"label",17),e._uU(8,"Sunset Time "),e.qZA(),e._UZ(9,"input",24),e.qZA()()())}function O(n,d){if(1&n){const p=e.EpF();e.TgZ(0,"div",25)(1,"p-button",26),e.NdJ("click",function(){e.CHM(p);const i=e.oxw();return e.KtG(i.insertStockData())}),e.qZA(),e._uU(2," \xa0\xa0\xa0\xa0\xa0\xa0"),e.TgZ(3,"p-button",27),e.NdJ("click",function(){e.CHM(p);const i=e.oxw();return e.KtG(i.resetData())}),e.qZA()()}}function I(n,d){1&n&&(e.TgZ(0,"div",28),e._UZ(1,"div")(2,"div")(3,"div")(4,"div")(5,"div"),e.qZA())}function k(n,d){1&n&&e._UZ(0,"div",29)}const L=function(){return{standalone:!0}};let x=(()=>{var n;class d{constructor(t,i,l,o,s,y,M){this.router=t,this.renderer=i,this.fb=l,this.http=o,this.messageService=s,this.confirmationService=y,this.api=M,this.filteredCountries=[],this.countries=[],this.selectedState=null,this.spinner=!1,this.alert_type="",this.manualLightON=!1,this.manualLightOFF=!1,this.manualMode=!1,this.client_id=+localStorage.getItem("c_id"),this.cities2=[{unit_name:"Auto (Time Based)",unit:0},{unit_name:"Manualy",unit:1}],this.states=[{name:"Arizona",code:"Arizona"},{name:"California",value:"California"},{name:"Florida",code:"Florida"},{name:"Ohio",code:"Ohio"},{name:"Washington",code:"Washington"}],this.dropdownItems=[{name:"Option 1",code:"Option 1"},{name:"Option 2",code:"Option 2"},{name:"Option 3",code:"Option 3"}],this.cities1=[],this.city1=null,this.city2=null,this.modelList=[],this.dealerList=[],this.lastAddedIndex=-1,this.stockIn=this.fb.group({device_id:[0,r.kI.required],device:["",r.kI.required],device_type:["",r.kI.required],device_mode:[0,r.kI.required],datalog_interval:[1,r.kI.required],sunrise_time:["",r.kI.required],sunset_time:["",r.kI.required],vrms:[0,r.kI.required],irms:[0,r.kI.required],device_switch:[0]})}ngOnInit(){this.ct=this.stockIn.controls,this.getDevice()}resetData(){this.stockIn.reset(),this.selectedCountryAdvanced=[],this.selectedDealer=[]}getDevice(){const t={client_id:this.client_id},i=this.api.baseUrl,l=localStorage.getItem("token"),o=(new h.WM).set("Authorization",`Bearer ${l}`);this.spinner=!0,this.http.post(i+"/client/devices/list",t,{headers:o}).subscribe(s=>{console.log(s),this.spinner=!1,this.data=s,this.models=this.data.data,this.filteredCountries=this.cities1[0],console.log(this.selectedDealer)},s=>{"401"==s.status&&this.router.navigate(["/"]),console.log(s.status),this.spinner=!1,"401"==s.status&&this.router.navigate(["/"]),console.log(s.status)})}getDeviceModel(){const t=this.api.baseUrl,i=localStorage.getItem("token"),l=(new h.WM).set("Authorization",`Bearer ${i}`);this.http.get(t+"/master/model_name",{headers:l}).subscribe(o=>{console.log(o),this.modelList=o,this.models=this.modelList.data},o=>{"401"==o.status&&this.router.navigate(["/"]),console.log(o.status),console.error(o)})}getDealer(){const t=this.api.baseUrl,i=localStorage.getItem("token"),l=(new h.WM).set("Authorization",`Bearer ${i}`);this.http.get(t+"/seller/list",{headers:l}).subscribe(o=>{console.log(o),this.dealerList=o,this.dealer=this.dealerList.data},o=>{"401"==o.status&&this.router.navigate(["/"]),console.log(o.status),console.error(o)})}insertStockData(){this.spinner=!0,console.log(this.selectedDealer);const t={device_id:this.selectedCountryAdvanced.device_id,device:this.selectedCountryAdvanced.device,device_type:"SL",device_mode:this.do_mode?this.do_mode:0,datalog_interval:this.ct.datalog_interval.value,vrms:0,irms:0,sunrise_time:this.convertToTimeWithSeconds(this.ct.sunrise_time.value),sunset_time:this.convertToTimeWithSeconds(this.ct.sunset_time.value),device_switch:this.manualMode&&this.manualLightON?1:this.manualMode&&this.manualLightOFF?0:null};console.log(t);const l=localStorage.getItem("token"),o=(new h.WM).set("Authorization",`Bearer ${l}`).set("Content-Type","application/json").set("Referrer-Policy","no-referrer");this.http.post("https://slapi.iotblitz.com/api/mqtt/publish_schedule",t,{headers:o,observe:"response",withCredentials:!0}).subscribe(s=>{console.log(s.body),"success"==s.body.status?(this.spinner=!1,this.messageService.add({severity:"success",summary:"Successful",detail:this.manualMode&&this.manualLightON?"Manual Setting with Light-ON Updated ":this.manualMode&&this.manualLightOFF?"Manual Setting with Light-OFF Updated ":"Settings Updated",life:3e3}),this.resetData()):(this.spinner=!1,this.messageService.add({severity:"error",summary:"Error",detail:"Data Related Issue!!",life:3e3}))},s=>{"401"==s.status&&this.router.navigate(["/"]),console.log(s.status),console.error(s),this.spinner=!1,this.messageService.add({severity:"error",summary:"Error",detail:"From Server Side !!",life:3e3}),console.error("API Error:",s)})}convertToTimeWithSeconds(t){return t.length<7?t+":00":t}filterCountry(t){const i=[],l=t.query;for(let o=0;o<this.models.length;o++){const s=this.models[o];0==s.device.toLowerCase().indexOf(l.toLowerCase())&&i.push(s)}this.filteredCountries=i}filterDealer(t){const i=[],l=t.query;for(let o=0;o<this.cities2.length;o++){const s=this.cities2[o];0==s.unit_name.toLowerCase().indexOf(l.toLowerCase())&&i.push(s)}this.filteredDealer=i}setWarranty(){this.warr_in_month=this.warr_in_month?this.warr_in_month:0;const t=new Date(this.ct.purchase_date.value);isNaN(t.getTime())?console.error("Invalid date input"):(t.setMonth(t.getMonth()+Number(this.warr_in_month)),this.stockIn.get("warranty_expired").setValue(t))}selected(){this.spinner=!0,console.log(this.selectedCountryAdvanced),this.modelID=this.selectedCountryAdvanced.device_id,this.company_n=this.selectedCountryAdvanced.devices;const t={client_id:this.client_id,device_id:this.selectedCountryAdvanced.device_id,device:this.selectedCountryAdvanced.device},i=this.api.baseUrl,l=localStorage.getItem("token"),o=new h.WM({Authorization:`Bearer ${l}`,Accept:"*/*","Content-Type":"application/json"});this.http.post(i+"/client/device_schedule",t,{headers:o}).subscribe(s=>{if(this.spinner=!1,console.log(s),this.dealerList=s,"SL"===this.dealerList?.data?.device_type){const y=this.cities2.find(M=>M?.unit==this.dealerList?.data?.device_mode);y&&(this.selectedDealer=y),this.stockIn.patchValue({device_type:"SL",datalog_interval:this.dealerList?.data?.datalog_interval,vrms:0,irms:0,sunrise_time:this.convertToTimeString(this.dealerList?.data?.sunrise_hour,this.dealerList?.data?.sunrise_min),sunset_time:this.convertToTimeString(this.dealerList?.data?.sunset_hour,this.dealerList?.data?.sunset_min)}),this.cities2=[{unit_name:"Auto (Time Based)",unit:0},{unit_name:"Manualy",unit:1}]}else this.stockIn.patchValue({device_type:"",device_mode:"",sunrise_time:"",sunset_time:"",datalog_interval:1,vrms:0,irms:0}),this.cities2=[{unit_name:"Auto (Time Based)",unit:0}]},s=>{this.spinner=!1,"401"==s.status&&this.router.navigate(["/"]),console.log(s.status),console.error(s)})}lightOn(){this.manualLightON=!0,this.manualLightOFF=!1,this.insertStockData()}lightOff(){this.manualLightON=!1,this.manualLightOFF=!0,this.insertStockData()}convertToTimeString(t,i){return`${t.padStart(2,"0")}:${i.padStart(2,"0")}:00`}setDealer(t){console.log(t),this.do_mode=t.unit,this.manualMode=1==t.unit}get skillsFormArray(){return this.stockIn.get("sl_no")}addSkill(){this.skillsFormArray.push(this.fb.control(""))}removeSkill(t){this.skillsFormArray.removeAt(t)}addItem(t){13===t.keyCode&&(this.addSkill(),this.lastAddedIndex=this.skillsFormArray.length,this.lastAddedIndex=this.skillsFormArray.length-1)}formatedDate(t){const l=new Date(t),M=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}-${String(l.getDate()).padStart(2,"0")}`;return console.log(M),M}}return(n=d).\u0275fac=function(t){return new(t||n)(e.Y36(f.F0),e.Y36(e.Qsj),e.Y36(r.qu),e.Y36(h.eN),e.Y36(g.ez),e.Y36(g.YP),e.Y36(m.s))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],viewQuery:function(t,i){if(1&t&&e.Gf(F,5),2&t){let l;e.iGM(l=e.CRH())&&(i.itemInput=l.first)}},features:[e._Bn([g.ez,g.YP])],decls:23,vars:17,consts:[[1,"grid"],[1,"col-8"],[1,"card"],[2,"display","flex"],[3,"formGroup"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12","md:col-6"],["htmlFor","firstname2"],["field","device",3,"ngModel","ngModelOptions","suggestions","dropdown","ngModelChange","onSelect","completeMethod"],[1,"field","col-12","md:col-4"],["field","unit_name",3,"ngModel","ngModelOptions","suggestions","dropdown","ngModelChange","onSelect","completeMethod"],["class","field col-12 md:col-10",4,"ngIf"],["class","field col-12 md:col-12",4,"ngIf"],[1,"col-4",2,"justify-content","center"],["class","loader",4,"ngIf"],["class","overlay",4,"ngIf"],[1,"field","col-12","md:col-10"],["htmlFor","city"],["inputId","Datalog Interval","formControlName","datalog_interval",3,"min"],[1,"grid",2,"border","1px solid rgb(212, 208, 208)"],[1,"field","col-12","md:col-2"],["icon","pi pi-check","styleClass","p-button-success",3,"rounded","click"],["icon","pi pi-times","styleClass","p-button-danger",3,"rounded","click"],["pInputText","","formControlName","sunrise_time","type","time"],["pInputText","","formControlName","sunset_time","type","time"],[1,"field","col-12","md:col-12"],["icon","pi pi-check","styleClass","p-button-primary ","label","Update Settings",3,"click"],["icon","pi pi-refresh","styleClass","p-button-danger","label","Reset",3,"click"],[1,"loader"],[1,"overlay"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"form",4)(5,"div",5)(6,"div",6)(7,"label",7),e._uU(8,"Select Device"),e.qZA(),e.TgZ(9,"p-autoComplete",8),e.NdJ("ngModelChange",function(o){return i.selectedCountryAdvanced=o})("onSelect",function(){return i.selected()})("completeMethod",function(o){return i.filterCountry(o)}),e.qZA()(),e.TgZ(10,"div",9)(11,"label",7),e._uU(12,"Device Mode:"),e.qZA(),e.TgZ(13,"p-autoComplete",10),e.NdJ("ngModelChange",function(o){return i.selectedDealer=o})("onSelect",function(o){return i.setDealer(o)})("completeMethod",function(o){return i.filterDealer(o)}),e.qZA()(),e.YNc(14,T,4,1,"div",11),e.YNc(15,S,13,2,"div",11),e.YNc(16,Z,10,0,"div",11),e.qZA(),e._UZ(17,"hr"),e.YNc(18,O,4,0,"div",12),e.qZA()()(),e._UZ(19,"div",13),e.qZA(),e._UZ(20,"p-toast"),e.YNc(21,I,6,0,"div",14),e.YNc(22,k,1,0,"div",15),e.qZA()),2&t&&(e.xp6(4),e.Q6J("formGroup",i.stockIn),e.xp6(5),e.Q6J("ngModel",i.selectedCountryAdvanced)("ngModelOptions",e.DdM(15,L))("suggestions",i.filteredCountries)("dropdown",!0),e.xp6(4),e.Q6J("ngModel",i.selectedDealer)("ngModelOptions",e.DdM(16,L))("suggestions",i.filteredDealer)("dropdown",!0),e.xp6(1),e.Q6J("ngIf",!i.manualMode),e.xp6(1),e.Q6J("ngIf",i.manualMode),e.xp6(1),e.Q6J("ngIf",!i.manualMode),e.xp6(2),e.Q6J("ngIf",!i.manualMode),e.xp6(3),e.Q6J("ngIf",i.spinner),e.xp6(1),e.Q6J("ngIf",i.spinner))},dependencies:[u.FN,c.O5,r._Y,r.Fj,r.JJ,r.JL,r.On,r.sg,r.u,_.Qc,v.zx,C.o,b.Rn],styles:['@use postcss-preset-env{stage: 0;}.on-off-toggle[_ngcontent-%COMP%]{width:56px;height:24px;position:relative;display:inline-block}.on-off-toggle__slider[_ngcontent-%COMP%]{width:56px;height:24px;display:block;border-radius:34px;background-color:#d8d8d8;transition:background-color .4s}.on-off-toggle__slider[_ngcontent-%COMP%]:before{content:"";display:block;background-color:#fff;box-shadow:0 0 0 1px #949494;bottom:3px;height:18px;left:3px;position:absolute;transition:.4s;width:18px;z-index:5;border-radius:100%}.on-off-toggle__slider[_ngcontent-%COMP%]:after{display:block;line-height:24px;text-transform:uppercase;font-size:12px;font-weight:700;content:"off";color:#484848;padding-left:26px;transition:all .4s}.on-off-toggle__input[_ngcontent-%COMP%]{position:absolute;opacity:0}.on-off-toggle__input[_ngcontent-%COMP%]:checked + .on-off-toggle__slider[_ngcontent-%COMP%]{background-color:#000}.on-off-toggle__input[_ngcontent-%COMP%]:checked + .on-off-toggle__slider[_ngcontent-%COMP%]:before{transform:translate(32px)}.on-off-toggle__input[_ngcontent-%COMP%]:checked + .on-off-toggle__slider[_ngcontent-%COMP%]:after{content:"on";color:#fff;padding-left:8px}*[_ngcontent-%COMP%]{box-sizing:border-box}body[_ngcontent-%COMP%]{font-family:OpenSans,sans-serif;height:100vh;display:flex;align-items:center;justify-content:center}']}),d})(),z=(()=>{var n;class d{}return(n=d).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[f.Bz.forChild([{path:"",component:x}]),f.Bz]}),d})();var U=a(6760),N=a(1480),P=a(3965),J=a(9663),w=a(8062),B=a(4055),Y=a(6218),Q=a(5359),j=a(7680);let W=(()=>{var n;class d{}return(n=d).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[g.ez,g.YP],imports:[u.EV,c.ez,r.u5,r.UX,z,_.WN,U._8,N.Gg,j.L,P.kW,J.zz,b.L$,w.XH,B.q4,Y.A,C.j,Q.x]}),d})()},5359:(A,D,a)=>{a.d(D,{i:()=>g,x:()=>e});var c=a(1180),r=a(4769),f=a(6814);const h=["*"];let g=(()=>{var m;class u{constructor(){(0,c.Z)(this,"style",void 0),(0,c.Z)(this,"styleClass",void 0),(0,c.Z)(this,"layout","horizontal"),(0,c.Z)(this,"type","solid"),(0,c.Z)(this,"align",void 0)}containerClass(){return{"p-divider p-component":!0,"p-divider-horizontal":"horizontal"===this.layout,"p-divider-vertical":"vertical"===this.layout,"p-divider-solid":"solid"===this.type,"p-divider-dashed":"dashed"===this.type,"p-divider-dotted":"dotted"===this.type,"p-divider-left":"horizontal"===this.layout&&(!this.align||"left"===this.align),"p-divider-center":"horizontal"===this.layout&&"center"===this.align||"vertical"===this.layout&&(!this.align||"center"===this.align),"p-divider-right":"horizontal"===this.layout&&"right"===this.align,"p-divider-top":"vertical"===this.layout&&"top"===this.align,"p-divider-bottom":"vertical"===this.layout&&"bottom"===this.align}}}return m=u,(0,c.Z)(u,"\u0275fac",function(v){return new(v||m)}),(0,c.Z)(u,"\u0275cmp",r.Xpm({type:m,selectors:[["p-divider"]],hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass",layout:"layout",type:"type",align:"align"},ngContentSelectors:h,decls:3,vars:4,consts:[["role","separator",3,"ngClass","ngStyle"],[1,"p-divider-content"]],template:function(v,C){1&v&&(r.F$t(),r.TgZ(0,"div",0)(1,"div",1),r.Hsn(2),r.qZA()()),2&v&&(r.Tol(C.styleClass),r.Q6J("ngClass",C.containerClass())("ngStyle",C.style))},dependencies:[f.mk,f.PC],styles:['.p-divider-horizontal{display:flex;width:100%;position:relative;align-items:center}.p-divider-horizontal:before{position:absolute;display:block;top:50%;left:0;width:100%;content:""}.p-divider-horizontal.p-divider-left{justify-content:flex-start}.p-divider-horizontal.p-divider-right{justify-content:flex-end}.p-divider-horizontal.p-divider-center{justify-content:center}.p-divider-content{z-index:1}.p-divider-vertical{min-height:100%;margin:0 1rem;display:flex;position:relative;justify-content:center}.p-divider-vertical:before{position:absolute;display:block;top:0;left:50%;height:100%;content:""}.p-divider-vertical.p-divider-top{align-items:flex-start}.p-divider-vertical.p-divider-center{align-items:center}.p-divider-vertical.p-divider-bottom{align-items:flex-end}.p-divider-solid.p-divider-horizontal:before{border-top-style:solid}.p-divider-solid.p-divider-vertical:before{border-left-style:solid}.p-divider-dashed.p-divider-horizontal:before{border-top-style:dashed}.p-divider-dashed.p-divider-vertical:before{border-left-style:dashed}.p-divider-dotted.p-divider-horizontal:before{border-top-style:dotted}.p-divider-dotted.p-divider-horizontal:before{border-left-style:dotted}\n'],encapsulation:2,changeDetection:0})),u})(),e=(()=>{var m;class u{}return m=u,(0,c.Z)(u,"\u0275fac",function(v){return new(v||m)}),(0,c.Z)(u,"\u0275mod",r.oAB({type:m})),(0,c.Z)(u,"\u0275inj",r.cJS({imports:[f.ez]})),u})()}}]);